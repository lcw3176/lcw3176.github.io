---
date: 2024-08-28
layout: post
title: 트래픽 유량제어
categories: [ETC]
image: >-
    https://github.com/user-attachments/assets/e77678b0-0048-479e-9a43-4e9827541933
---

## 사망 플래그

![spaces_7BPEtM5qOBElefnOmX3S_uploads_0FRy2SSzk8Ldbgfv8x2z_image](https://github.com/user-attachments/assets/192f90bc-955c-49c8-b465-a7e591a0f828)

평화롭던 오후에 네이버 클라우드에서 메일이 왔다. 

흔한 점검 안내 메일인가 싶어 대충 보려던 순간, '비정상 트래픽', '서비스 정지 예고' 같은 웬 어마무시한 키워드들이 있길래 빨리 눌러봤다.

내용은 더 어마무시했다. 
최근에 코드 변경사항도 크게 없긴 했는데 마구잡이로 호출하던 업보가 쌓였는지, 경고메일이 왔다.
혹시 자동으로 나가는 메일인가 했는데, 센트리에 ip 찍힌 내역 확인해보니 사람이 들어와서 확인은 해보는것 같다.
뭐가됐든 빨리 대처를 해야했다.

## 환장의 타이밍

![image](https://github.com/user-attachments/assets/e784b517-8bd7-4653-9e7f-1dd72d112dc7)

하지만 당장 대처하기 난감했던 이유가 국토교통부쪽 관련 API 연장 심사 기간이었는데, 네이버 지도랑 기능이 엮여있다. 
네이버 지도 기능을 임시로 없애버리면 국토교통부쪽 기능도 다 날아가버리는 셈이라서 빨리 분리를 해야하나 했는데, 
관련 소개 자료들도 이미 다 제출해버려서 머리 과부하 중이었다.

그런데 정말 다행히도 저 메일 날아오기 직후로 연장 심사가 끝이났다. 
거의 한달전부터 진행된 연장심사인데 진짜 타이밍 예술이었다. 자칫하면 다 꼬일뻔했다.
어쨌든 일단 급하게 api 호출을 막았다. 키값을 비활성화 시킬까 하다가 그냥 프론트쪽 주석 몇개 쳐서 배포했다. 
임시로 해당 기능 호출하는 ui들을 전부 없앴다.

## 원인 분석

![image](https://github.com/user-attachments/assets/3ec003fe-1b84-4ac8-8379-0e567a421075)


![제목 없음 (1)](https://github.com/user-attachments/assets/259ff457-87b3-46c4-a55a-ec7d9a6034ab)

## 참고

- 내 경험, 생각