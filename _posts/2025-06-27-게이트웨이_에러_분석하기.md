---
date: 2025-06-27
layout: post
title: 게이트웨이 에러 분석하기
categories: [Devops]
image: https://github.com/user-attachments/assets/ce432444-14f6-4d7e-b3aa-fe89cffd81c1
---

클라우드 인프라 설정쪽에서 문제가 나서, 팀 내부적으로 관련 정보 공유를 할 것 같은데 겸사겸사 블로그에도 정리해본다.
내부에서 발표하는 것보다 공유할 수 있는 자료가 극히 제한적일테지만, 어찌저찌 잘 추상화해서 표현해보려한다.
읽다가 뭔가 건너뛰고 흐름이 끊기는 내용이 느껴져도 어쩔수(?) 없다. 최대한 노력해서 써봐야겠다.

## 문제 상황

특정 url을 비활성화 시켰는데, 서버 접속 자체가 안되는 현상이었다.

특이한 점은 내부망에서는 접속이 잘 붙고, 별도의 도메인으로 접근하는 외부망에서는 502 배드 게이트웨이 에러가 났다.
게다가 우리는 클라우드 리소스에 일부 접근 권한만 있어서, 구성이 어떻게 되어 있는지 감도 잘 안오고 껜또로 찍어 맞춰야 했기 때문에 더 어려웠던 것 같다.

## 분석

이유가 뭘까 계속 고민하던 중, 한 가지 눈에 띄는 창이 들어왔다.
평소에는 보이지 않던 '앱이 비정상입니다' 라는 클라우드 자체 경고 문구였다.

이 경구 문구가 왜 뜨나 살펴봤더니, 헬스 체크 url로 요청을 보내고 200~399 사이의 응답이 오지 않으면 비정상이라고 판단하고 있었다.
그리고 하필 그 url은 우리가 이번에 비활성화 시켰던 주소였다.
