---
date: 2025-06-05

layout: post
title: sentry ìì²´ êµ¬ì¶•í•˜ê¸°
categories: [Devops]
image: https://github.com/user-attachments/assets/20ed99f2-d5c6-42a1-8ade-b6f68b6772df
---

## self hosted sentry

ì„¼íŠ¸ë¦¬ê°€ ìì²´ êµ¬ì¶•ì‹œì—ë„ ìš”ê¸ˆì„ ì§€ë¶ˆí•˜ëŠ” ì¤„ ì•Œì•˜ëŠ”ë°, ê·¸ê±´ ì•„ë‹Œ ê²ƒ ê°™ë‹¤.

ì˜¤í”ˆì†ŒìŠ¤ì˜€ê³ , ì´ê±¸ ìì‚¬ í”„ë¡œë•íŠ¸ì™€ ë¼ì›ŒíŒŒëŠ” í–‰ìœ„ê°€ ê¸ˆì§€ë˜ëŠ” ê²ƒì´ì—ˆë‹¤. ë‚´ë¶€ êµ¬ì¶•í•´ì„œ ëª¨ë‹ˆí„°ë§ ìš©ë„ë¡œ ì“°ëŠ” ê±´ ê´œì°®ë‹¤ë”ë¼.
ìš°ë¦¬ íŒ€ ëª¨ë‹ˆí„°ë§ ìš©ë„ë¡œ ì“°ê¸°ì—” ì¢€ ì•ˆ ë§ê¸´ í•œë°, í•˜ë‚˜ì˜ url ë„¤íŠ¸ì›Œí¬ ìš”ì²­ë§ˆë‹¤ ì–´ë–¤ apië‚˜ DB ì¿¼ë¦¬ê°€ ë‚˜ê°€ëŠ”ì§€ ê´€ì°°í•˜ê¸°ì—ëŠ” ìµœì ì˜ ìš©ë„ë¼ê³  ìƒê°í•˜ê¸°ì— ì ì‹œ êµ¬ì¶•í•´ë´¤ë‹¤.
íšŒì‚¬ ê³„ì •ìœ¼ë¡œ ë§¤ë‹¬ 20ë§Œì›ì”© í¬ë ˆë”§ì´ ë‚˜ì˜¤ëŠ”ë°, ì´ê±¸ë¡œ ì´ê²ƒ ì €ê²ƒ ì‹¤í—˜í•´ë³´ê¸°ì—ëŠ” ì°¸ ì¢‹ì€ ê²ƒ ê°™ë‹¤.
ì–´ì¨Œë“ , êµ¬ì¶• ê³¼ì •ì„ ê¸°ë¡í•´ë³´ì.

## ë„ì»¤ ì…‹ì—…

![image](https://github.com/user-attachments/assets/65cda57e-5215-45ee-bf35-8eb3bc73ab05)

ë¨¼ì € ì„œë²„ í•˜ë‚˜ ë¹Œë¦¬ê³  ë„ì»¤ë¥¼ ì„¤ì¹˜í•´ì£¼ì. 
ê³µì‹ ì‚¬ì´íŠ¸ì—ì„œ ìµœì†Œ ê¶Œì¥ ì‚¬ì–‘ì´ 4ì½”ì–´ì— 16ê¸°ê°€ ë¨ì´ë¼ê³  í•´ì„œ ìµœì†Œì‚¬ì–‘ì— ë§ê²Œ ë¹Œë ¤ë´¤ë‹¤. 
ì´ë ‡ê²Œë§Œ ëŒ€ì—¬í•´ë„ 20ë§Œì›ì´ ë„˜ì–´ì„œ, ë§¤ì¼ ì˜¤í›„ 9ì‹œë§ˆë‹¤ ì„œë²„ êº¼ì§€ê²Œ í•´ë†¨ë‹¤.

ê·¸ë¦¬ê³  ë¯¸ë˜ì˜ ë‚˜ë¥¼ ìœ„í•´ì„œ ë©”ëª¨ë¥¼ ë‚¨ê²¨ë‘ìë©´, ì € ìŠ¤í™ ë¶€ì¡±í•œ ê²ƒ ê°™ë‹¤. 
ë¨ ë” í•„ìš”í•œ ê²ƒ ê°™ë‹¤. ë§Œì•½ì— ë‹¤ì‹œ ë¦¬ì†ŒìŠ¤ ìƒì„±í•œë‹¤ë©´ ì¡°ê¸ˆ ë” ë„ë„í•˜ê²Œ í•˜ë„ë¡ í•˜ì...

ë„ì»¤ì™€ ì»´í¬ì¦ˆ ì„¤ì¹˜ ìŠ¤í¬ë¦½íŠ¸ëŠ” gptí•œí…Œ ì‹œì¼œì„œ ìŠ¤í¬ë¦½íŠ¸ ì§œë‹¬ë¼ê³  í–ˆë‹¤. 
ì´ëŸ° ì‘ì—… í•  ë•ŒëŠ” ì°¸ í¸í•œ ê²ƒ ê°™ë‹¤.
gptê°€ ì‘ì„±í•´ì¤€ ìŠ¤í¬ë¦½íŠ¸ëŠ” ë‹¤ìŒê³¼ ê°™ë‹¤.

```sh
echo "â–¶ï¸ 1. ë„ì»¤ ì´ì „ ë²„ì „ ì œê±°"
sudo apt-get remove -y docker docker-engine docker.io containerd runc || true

echo "â–¶ï¸ 2. í•„ìˆ˜ íŒ¨í‚¤ì§€ ì„¤ì¹˜"
sudo apt-get update
sudo apt-get install -y \
    ca-certificates \
    curl \
    gnupg \
    lsb-release

echo "â–¶ï¸ 3. Docker GPG í‚¤ ì¶”ê°€"
sudo install -m 0755 -d /etc/apt/keyrings
curl -fsSL https://download.docker.com/linux/ubuntu/gpg | \
    sudo gpg --dearmor -o /etc/apt/keyrings/docker.gpg
sudo chmod a+r /etc/apt/keyrings/docker.gpg

echo "â–¶ï¸ 4. Docker ì €ì¥ì†Œ ì¶”ê°€"
echo \
  "deb [arch=$(dpkg --print-architecture) signed-by=/etc/apt/keyrings/docker.gpg] \
  https://download.docker.com/linux/ubuntu \
  $(lsb_release -cs) stable" | \
  sudo tee /etc/apt/sources.list.d/docker.list > /dev/null

echo "â–¶ï¸ 5. Docker ì—”ì§„ ì„¤ì¹˜"
sudo apt-get update
sudo apt-get install -y docker-ce docker-ce-cli containerd.io docker-buildx-plugin docker-compose-plugin

echo "âœ… ë„ì»¤ ì„¤ì¹˜ ì™„ë£Œ"

echo "â–¶ï¸ 6. ë„ì»¤ ê¶Œí•œ ì„¤ì • (í˜„ì¬ ì‚¬ìš©ìì—ê²Œ docker ê·¸ë£¹ ì¶”ê°€)"
sudo usermod -aG docker $USER
echo "âœ… í˜„ì¬ ì‚¬ìš©ìë¥¼ docker ê·¸ë£¹ì— ì¶”ê°€í–ˆìŠµë‹ˆë‹¤. ë³€ê²½ ì‚¬í•­ì„ ì ìš©í•˜ë ¤ë©´ ì¬ë¡œê·¸ì¸ì´ í•„ìš”í•©ë‹ˆë‹¤."

echo "â–¶ï¸ 7. ë„ì»¤ ë° ë„ì»¤ ì»´í¬ì¦ˆ ë²„ì „ í™•ì¸"
docker --version
docker compose version

echo "ğŸ‰ ëª¨ë“  ì‘ì—… ì™„ë£Œ!"
```

ê·¸ ë‹¤ìŒì€ ê³µì‹ ë¬¸ì„œì— ìˆëŠ” ìŠ¤í¬ë¦½íŠ¸ ëŒ€ë¡œ ì‹¤í–‰í•´ì£¼ì.
ë‚˜ëŠ” ì§€ì˜¤ ë­ì‹œê¸°, ê·¸ëŸ¬ë‹ˆê¹Œ ì§€ë¦¬ ê´€ë ¨ ì»¨í…Œì´ë„ˆê°€ ì‘ë™ì„ ì•ˆí–ˆë˜ ê²ƒ ê°™ì€ë° ëª‡ ë²ˆì„ ë” ì¼œë´ë„ ë™ì¼í–ˆë˜ ê±¸ ë³´ë©´
ë©”ëª¨ë¦¬ ë¶€ì¡±ì¸ ê²ƒ ê°™ë‹¤. ë‹¤ìŒì—” ë„ë„í•˜ê²Œ ë¹Œë¦¬ì. ì„œë²„ê°€ ë§ì´ í˜ë“¤ì–´í•œë‹¤.

```sh
VERSION=$(curl -Ls -o /dev/null -w %{url_effective} https://github.com/getsentry/self-hosted/releases/latest)
VERSION=${VERSION##*/}
git clone https://github.com/getsentry/self-hosted.git
cd self-hosted
git checkout ${VERSION}
./install.sh
# After installation, run the following to start Sentry:
docker compose up --wait
```

![image](https://github.com/user-attachments/assets/bf15326a-c5b0-4acc-82a7-a4f992be20d0)

ì´ê±°ëŠ” ì •ë³´ë¥¼ ìµëª…ìœ¼ë¡œ ë³´ë‚¼ì§€ ë§ì§€ ë™ì˜í•˜ëŠ” ë¬¸êµ¬ë“¤ ê°™ì€ë°, ì•„ë¬´ë˜ë„ íšŒì‚¬ ì½”ë“œë¼ ë‹¤ ë…¸ë…¸ë…¸ í–ˆë‹¤.

![image](https://github.com/user-attachments/assets/0095465c-1c24-4c3a-8fda-930ea26d3a03)

ì‹¤í–‰ì´ ì™„ë£Œë˜ë©´ í¬íŠ¸ë¥¼ ì—´ì–´ì¤˜ì•¼ í•œë‹¤. ê¸°ë³¸ì ìœ¼ë¡œ 9000ë²ˆ í¬íŠ¸ë¥¼ ì‚¬ìš©í•œë‹¤.
ë‚˜ëŠ” ê·€ì°®ì•„ì„œ 9000 í¬íŠ¸ë¥¼ ë¦¬ë‹¤ì´ë ‰íŠ¸ ì‹œì¼œì¤¬ë‹¤. 
ì„ì‹œë¡œ ì ê¹ í˜¸ìŠ¤íŒ…í•˜ëŠ”ê±°ë¼ ì¸ì¦ì„œë„ ê·€ì°®ì•„ì„œ ì•ë‹¨ì— í´ë¼ìš°ë“œí”Œë ˆì–´ë¡œ ëŒ€ì¶© ë•Œì› ë‹¤.

```sh
# root ê¶Œí•œ í™•ì¸
if [ "$EUID" -ne 0 ]; then
  echo "ì´ ìŠ¤í¬ë¦½íŠ¸ëŠ” root ê¶Œí•œìœ¼ë¡œ ì‹¤í–‰ë˜ì–´ì•¼ í•©ë‹ˆë‹¤."
  exit 1
fi

# firewalld ì‹¤í–‰ ì¤‘ì¸ì§€ í™•ì¸
if ! systemctl is-active --quiet firewalld; then
  echo "firewalldê°€ ì‹¤í–‰ ì¤‘ì´ ì•„ë‹™ë‹ˆë‹¤. ì‹œì‘í•©ë‹ˆë‹¤..."
  systemctl start firewalld
fi

# ë¦¬ë””ë ‰ì…˜ ì„¤ì • (í¬íŠ¸ 80 â†’ 9000)
echo "í¬íŠ¸ 80ì„ 9000ìœ¼ë¡œ ë¦¬ë””ë ‰ì…˜ ì„¤ì • ì¤‘..."

firewall-cmd --permanent --add-forward-port=port=80:proto=tcp:toport=9000
firewall-cmd --reload

echo "ì„¤ì • ì™„ë£Œ: í¬íŠ¸ 80 â†’ 9000 (ì˜êµ¬ ì ìš©ë¨)"
```

ë‚˜ë¨¸ì§€ëŠ” ê³µì‹ ë¬¸ì„œëŒ€ë¡œ ì„¤ì •í•´ì£¼ë©´ ëœë‹¤. ì˜ì¡´ì„± ì„¤ì¹˜í•˜ê³ , í•˜ë¼ëŠ” ëŒ€ë¡œ ì½”ë“œ ì…‹ì—…ì„ ì§„í–‰í•´ì¤€ë‹¤.
ìš°ë¦¬ëŠ” FastAPIë‘ ë¦¬ì•¡íŠ¸ë¥¼ ì‚¬ìš©ì¤‘ì´ê¸° ë•Œë¬¸ì— ìš”ë˜ì¡°ë˜ ì½”ë“œë¥¼ ì ë‹¹íˆ ë„£ì–´ì¤¬ë‹¤.

```python
pip install --upgrade "sentry-sdk[fastapi]>=2.24.1"
## ....


import sentry_sdk

sentry_sdk.init(
    dsn="...",
    # Set traces_sample_rate to 1.0 to capture 100%
    # of transactions for tracing.
    traces_sample_rate=1.0,
    # Set profiles_sample_rate to 1.0 to profile 100%
    # of sampled transactions.
    # We recommend adjusting this value in production.
    profiles_sample_rate=1.0
)
```

```javascript
import * as Sentry from "@sentry/react";

Sentry.init({
  dsn: "...",
  integrations: [
    Sentry.browserTracingIntegration(),
    // Or, if you are using react router, use the appropriate integration
    // See docs for support for different versions of react router
    // https://docs.sentry.io/platforms/javascript/guides/react/configuration/integrations/react-router/
  ],
  // For finer control of sent transactions you can adjust this value, or
  // use tracesSampler
  tracesSampleRate: 1.0,
  // Set `tracePropagationTargets` to control for which URLs trace propagation should be enabled
  tracePropagationTargets: ["localhost", /^https:\/\/yourserver\.io\/api/],
});

```

ì´ë ‡ê²Œ ë„£ì–´ì£¼ë©´ ì´ìŠˆ, íŠ¸ëœì­ì…˜ ë“±ë“± ì¡íˆê¸° ì‹œì‘í•  ê²ƒì´ë‹¤.

## ì¶œì²˜

- https://develop.sentry.dev/self-hosted/
