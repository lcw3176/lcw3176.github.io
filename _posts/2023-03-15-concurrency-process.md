---
date: 2023-03-15
layout: post
title: 병행 프로세스
subtitle: '병행 프로세스에 대하여'
description: 병행 프로세스에 대하여
image: >-
  https://img.shields.io/badge/concurrency_process-blue?style=for-the-badge
category: cs
author: coldrain
---
## Concurrency Process 

### 병행성, 병행 프로세스

![작업관리자](https://user-images.githubusercontent.com/59993347/225233350-d7d976db-ca65-4372-8e06-0028db832233.jpg)

병행성이란 여러 개의 프로세스 또는 쓰레드가 동시 수행되는 시스템의 특성이다.
병행 프로세스는 동시 수행되는 여러 개의 프로세스 또는 쓰레드를 말하며,
윈도우 환경에서는 Ctrl + Alt + Delete 키를 눌러 작업관리자에 들어가면
현재 수행되는 여러 개의 프로세스들을 확인 가능하다.

### 병행 프로세스의 실행 형태

#### 1개의 CPU: 인터 리빙 형식

![인터리빙](https://user-images.githubusercontent.com/59993347/225234177-58cb9bd0-5537-4009-a459-2504b994f1ca.jpg)

다수의 프로세스가 CPU에 사용 요청을 하면, 
CPU는 각각의 태스트를 단일 처리한다 

#### 여러 개의 CPU: 병렬 처리 형식

![병렬](https://user-images.githubusercontent.com/59993347/225234238-b58eac63-d6c0-4bef-9bac-3f9584b81349.jpg)

CPU 코어가 다수일 경우 각각의 프로세스를
개별 코어에서 처리한다.

## 프로세스 간의 관계
### 독립 프로세스
수행 중인 다른 프로세스에 영향을 주지도, 받지도 않으며
데이터 및 상태를 다른 프로세스와 공유하지 않는다.
이러한 독립 프로세스의 실행에는 두 가지 특성이 있다.

1. 결정적: 실행결과는 입력에 의해서만 결정되며, 다른 요인에 영항을 받지 않는다.
2. 재생 가능: 결정적인 특성 때문에, 같은 입력에 대해서는 항상 동일한 실행 결과를 반환한다.

### 협력 프로세스
독립 프로세스와 대조되는 프로세스로,
수행 중인 다른 프로세스와 영향을 주고받으며.
데이터 및 상태를 다른 프로세스와 공유한다.

1. 비결정적: 실행결과가 실행 순서 or 다른 요인들에 의해 좌우된다.
2. 재생 불가능: 같은 입력에 대해 항상 동일한 실행 결과를 보장받지 못한다.

## 상호 배제

임계영역에 대한 동기화 문제이다.

### 임계 영역

2개 이상의 프로세스가 동시에 사용하면 안 되는 공유자원을 액세스 하는 
프로그램 코드 영역이다. 


## 상호배제 해결
### 해결을 위한 보장

- 한 프로세스가 임계영역을 수행 중일 때
  - 다른 프로세스는 임계영역에 진입해서는 안 된다
- 임계영역 수행 중이던 프로세스가 임계영역을 벗어났을 때
  - 하나의 누군가는 임계영역을 새로 수행할 수 있어야 한다.
- 임계영역 진입을 못하고 대기하는 프로세스 일 때
  - 적절한 시간 내에 임계영역에 대해 수행을 시작할 수 있어야 한다.

### 해결을 위한 주변의 코드 영역

```
|진입영역| 임계영역에 대한 수행 가능 여부를 확인

|임계영역|

|해제영역| 다른 프로세스가 임계영역 수행을 시작할 수 있도록 작동
```

## 세마포어(semaphore)

상호배제와 동기화 문제를 해결하기 위한 도구로서, 다익스트라가 제안한 방식이며
**정수형 공용 변수**를 사용해 문제를 해결한다.

사용 가능한 자원의 수 or 잠김이나 풀림의 상태를 변수에 저장하며,
기본적으로는 0 이상인 정수로 초기화를 하여 사용하지만, 상황에 맞게 변형이 가능하다.

두 기본연산인 **P와 V**에 의해서만 사용되는데,
여기서 기본 연산은 인터럽트 되지 않고 하나의 단위로 처리되며,
세마포어마다 대기 큐가 필요하다.

### 연산 P
```c
void P(semaphore s)
{
  if (s > 0)
  {
    s--;
  }

  else 
  {
    // 프로세스 대기
  }
}
```

무엇인가를 검사하거나, 감소시키려는 시도를 말한다.

### 연산 V
```c
void V(semaphore s)
{
  if (대기 중인 프로세스 없음)
  {
    s++;
  }

  else 
  {
    // 대기 중인 프로세스 1개 진행
  }
}
```

무엇인가를 증가시키는 연산을 말한다.

### 세마포어 사용

```
<!-- mutex 초깃값 1 -->
<!-- 대기 큐는 FIFO로 동작 -->

...
|P(mutex)| mutex 값이 0보다 큰 지 검사, 임계영역 진입 시 0으로 값 변경

|임계영역|

|V(mutex)| 만약 대기하는 프로세스가 있다면 깨우고, mutex 값을 증가시켜 1로 세팅한다.  
...

```


#### 참고

- 김진욱(자연과학대학 컴퓨터과학과부교수), 운영체제: 병행 프로세스 I, 방송통신대학교, 2023.03.15


